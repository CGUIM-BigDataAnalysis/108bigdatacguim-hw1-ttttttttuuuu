---
title: "108-2 大數據分析方法 作業一"
output: github_document
author: Wong Kin Tung
---

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**- （107年）https://data.gov.tw/dataset/6647 （104-105年）http://ipgod.nchc.org.tw/dataset/a17000000j-020066 ，可初步了解台灣近幾年各行各業、各學歷的起薪。

## 比較104年度和107年度大學畢業者的薪資資料

### 資料匯入與處理
```{r dataload,echo=FALSE}
library(readr)
library(dplyr)
library(stringr)
library(data.table)
library(knitr)

#107年度大學畢業者的資料
X107 <- read_csv("~/Downloads/A17000000J-020066-Qod/107年各教育程度別初任人員每人每月經常性薪資─按大職類分.csv")
#104年度大學畢業者的資料
X104<- read_csv("http://ipgod.nchc.org.tw/dataset/b6f36b72-0c4a-4b60-9254-1904e180ddb1/resource/98d5094d-7481-44b5-876a-715a496f922c/download/a17000000j-020066-mah.csv")

#因為104/107年大職業別中的資料名稱有差異，所以透過gusb（）作修改
#X104$大職業別<-gsub("部門","",X104$大職業別) 
#合併兩個資料表
#inner_join(X107,X104,by="大職業別")


```

### 107年度薪資較104年度薪資高的職業有哪些? 
```{r warning=F,compare103106 }
#1:將薪資欄位轉為數字型態
X107$`經常性薪資-薪資`<-as.numeric(X107$`經常性薪資-薪資`)
X104$`經常性薪資-薪資`<-as.numeric(X104$`經常性薪資-薪資`)

#2:將107和104年的薪資，工作及薪資提升存到新的資料框,方便之後計算和運用
X1<-data_frame(Job=X107$大職業別,
               Money107=X107$`經常性薪資-薪資`,
               Money104=X104$`經常性薪資-薪資`,
               提高薪資=X107$`經常性薪資-薪資`-X104$`經常性薪資-薪資`)

#3:按薪資提升幅度排序
X1<-X1[order(X1$提高薪資,decreasing = TRUE),]

#4:只保存薪資107>104年的工作
X1_new<-X1$Job

#107年度薪資較104年度薪資高的職業有127個

#5:呈現前10名提升最高的的資料
kable(head(X1_new,10))

#透過107和104年資料的分析，可以看出薪資提升最高的職業為不動產業的技術員工及勞力工




```

### 提高超過5%的的職業有哪些? 
```{r over5}
#1:找出107年度高於104年度薪資提高5%的薪資
X2_new<-subset(X1,X1$Money107>(X1$Money104*(1+0.05)))

#超出5%的職業
X2_new<-X2_new$Job 

#在107年有84個職業超過104年5%
kable(X2_new)
```

### 主要的職業種別是哪些種類呢?
```{r mainType}
#方法一
#X3_1<-X107[grepl("-",X107$大職業別),]#找出有-出現的職業（）
#X3_end<-X3_1$大職業別 #存進X3_1
#X3_end<-strsplit(X3_end,"-") #以-為切割條件
#X3_1[[1]][1] 檢查 --切割資料成功 以list儲存，而list元素的第一個則是我們要的資料
#X3_end<-lapply(X3_end,"[", 1) #利用lapply（）取出X3[[n]][1]中所有第一個
#X3_end<-unlist(X3_end)#轉為字串
#X3_end<-unique(X3_end)#刪減重複的職業
#X3_end #主要職業有20種

#方法二
#“-”後的工作都為該行業中的衍生，所以要篩選出沒有“-”的觀察值-工作的種類
X3_1_best<-X107[!grepl("-",X107$大職業別),]

#主要的工作類別
kable(X3_1_best$大職業別)

#主要的工作類別有20種
```

## 男女同工不同酬現況分析

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為103到106年度的大學畢業薪資。

### 104和107年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?
```{r male, warning=F}
#1:找出有"-"出現的職業,有"-"符號的則不包括職業種類在其中
X104_new<-X104[grepl("-",X104$大職業別),]
X107_new<-X107[grepl("-",X107$大職業別),]
#2:轉為數字型態
X104_new$`大學-女/男`<-as.numeric(as.character(X104_new$`大學-女/男`))
X107_new$`大學-女/男`<-as.numeric(as.character(X107_new$`大學-女/男`))

#3:找出<100的值（女/男<100%代表分母比分子大，男大於女）
 X4_104<-subset(X104_new,X104_new$`大學-女/男`<100) 
 X4_107<-subset(X107_new,X107_new$`大學-女/男`<100)
 
 #4:以小>大排序--數字越小代表差距越大
 X4_104<-X4_104[order(X4_104$`大學-女/男`),]
 X4_107<-X4_107[order(X4_107$`大學-女/男`),]
 
 kable(head(X4_104$大職業別,10))
 #以上為104年大學生畢業，男生薪資大於女生薪資最多的前10筆
kable( head(X4_107$大職業別,10))
 #以上為107年大學生畢業，男生薪資大於女生薪資最多的前10筆

```
### 哪些行業女生薪資比男生薪資多? 
```{r female}

#找出>100的值（女/男>100%代表分子比分母大，女大於男）
 kable(subset(X104_new,X104_new$`大學-女/男`>100))
 kable(subset(X107_new,X107_new$`大學-女/男`>100))
 
 #在104年只有專業、科學及技術服務業-技藝、機械設備操作及組裝人員
 #107年則沒有。

```

## 研究所薪資差異

以107年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?
 
```{r grad,warning=FALSE}
#1:大學生及研究生薪資資料

#107年學生薪資資料
X107$`大學-薪資`<-as.numeric(X107$`大學-薪資`)     #轉為數字型態
X107$`大學-薪資`[is.na(X107$`大學-薪資`)]<-0       #將NA值設為0方便計算
#107年研究生薪資資料
X107$`研究所-薪資`<-as.numeric(X107$`研究所-薪資`) #轉為數字型態
X107$`研究所-薪資`[is.na(X107$`研究所-薪資`)]<-0   #將NA值設為0方便計算

#2:將研究生薪資和大學薪資存進新的資料框方便比對，且增加新的欄位-增加比例，查看學歷對薪資的影響。
X6<-data.frame(Job=X107$大職業別,
               大學生薪資=X107$`大學-薪資`,
               研究所薪資=X107$`研究所-薪資`,
               增加比例=X107$`研究所-薪資`/X107$`大學-薪資`)

#3，按薪資增加最多的排序
X6_max<-X6[order(X6$增加比例,decreasing = TRUE),]

#薪資增加比例最多的前10個職業
kable(head(X6_max,10))

#這些職業的工作都是沒有研究生畢業的就職的
X6_min<-subset( X6,X6$增加比例==0)
kable(X6_min)
#所以如果想從事這些行業的工作不需要讀到研究生畢業，大學生畢業就可以去就職了。
```

## 我有興趣的職業別薪資狀況分析

   我感興趣的工作大概為金融行業，可能因為與我生活在的城市有關-香港，身邊很多人在高中沒有畢業之前，就有花時間投資在金融及保險行業上，對於他們來說這是賺快錢的方法，也是唯一的經濟來源。
   所以我想探討的問題是-
   1:這份行業對於學歷的要求是否重要
   2:薪資水平差距是否能反映在學歷上
   
### 有興趣的職業別篩選，呈現薪資
```{r like}
#1：我有興趣的職業類別
X7_mine<-X107_new[grepl("金融",X107_new$大職業別),]

kable(X7_mine)

```

### 這些職業別研究所薪資與大學薪資差多少呢？
```{r likeGrad,warning=F}
#2:將薪資轉為數字型態/將NA值設設為0方便計算
X7_mine$`大學-薪資`<-as.numeric(X7_mine$`大學-薪資`)
X7_mine$`大學-薪資`[is.na(X7_mine$`大學-薪資`)]<-0
X7_mine$`研究所-薪資`<-as.numeric(X7_mine$`研究所-薪資`)
X7_mine$`研究所-薪資`[is.na(X7_mine$`研究所-薪資`)]<-0
#高中薪資-因為我更想探討這份工作在學歷不高的情況下是否一樣受歡迎
X7_mine$`高中或高職-薪資`<-as.numeric(X7_mine$`高中或高職-薪資`)
X7_mine$`高中或高職-薪資`[is.na(X7_mine$`高中或高職-薪資`)]<-0


#3:將職業，高中/大學/研究生薪資及相差設為資料框，方便查閱，作分析
X8_mine<-data.frame(Job=X7_mine$大職業別,
                    高中薪資=X7_mine$`高中或高職-薪資`,
                    大學薪資=X7_mine$`大學-薪資`,
                    研究生薪資=X7_mine$`研究所-薪資`,
                    大學與高中相差=X7_mine$`大學-薪資`-X7_mine$`高中或高職-薪資`,
                    研究生與大學相差=X7_mine$`研究所-薪資`-X7_mine$`大學-薪資`)

#不需要就讀到研究生的工作
X8_mine_min1<-subset(X8_mine,研究生與大學相差<0)
kable(X8_mine_min1)
#不需要就讀到大學的工作
X8_mine_min2<-subset(X8_mine,大學與高中相差<0)
kable(X8_mine_min2)

#就讀到研究生，薪資有提升的工作
X8_mine_max<-subset(X8_mine,研究生與大學相差>0)
kable(X8_mine_max)
#就讀到大學，薪資有提升的工作
X8_mine_max2<-subset(X8_mine,大學與高中相差>0)
kable(X8_mine_max2)

#4:將我感興趣的工作及相差值列出-清晰的列出有用的資料
X8_mine_END<-data.frame(Job=X7_mine$大職業別,
                        大學與高中相差=X7_mine$`大學-薪資`-X7_mine$`高中或高職-薪資`,
                        研究生與大學相差=X7_mine$`研究所-薪資`-X7_mine$`大學-薪資`)
kable(X8_mine_END)
#1，根據分析,薪資水平在該行業中雖然有透過學歷的上漲提升，但也有些不需要高學歷就能完成的工作。
#2，部分學生提早花時間投資在金融行業中而不是在大學或研究生學業上是合理的，因為的確薪資相差水平不大--（學歷的提升：薪資的提升）有正相關的趨勢，但上升趨勢不足以支撐要花更多時間及金錢到學歷中。
```

